<%- include('navigationbar') %>
        <!-- Header Section End -->
         <style>
body{
background:#eee;
}
         </style>
        <link rel="stylesheet" href="css/adress-book.css" type="text/css" />

        <!-- Breadcrumb Section Begin -->
        <section class="breadcrumb-option">
            <div class="container">
                <div class="row">
                    <div class="col-lg-12">
                        <div class="breadcrumb__text">
                            <h4>Shop</h4>
                            <div class="breadcrumb__links">
                                <a href="/home">Home</a>
                                <span>User</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
        <!-- Breadcrumb Section End -->
        
<div class="container mb-4 main-container">
    <div class="row">
        <div class="col-lg-4 pb-5">
            <!-- Account Sidebar-->
          <%- include('profilesidebar') %>
            
        </div>
        <!-- Orders Table-->
        <% if (shippingAddress && shippingAddress.length> 0) { %>
            <div class="col-lg-4 col-md-6 col-sm-6">
                <div class="product__item">
                    <div class="product__item__text">
                        <div class="address-type">
                            <div class="address-heading">
                                <div class="address-label">
                                    <div class="address-name">
                                        <div class="default-shipping-address">
                                            Default Shipping Address
                                        </div>
                                    </div>
                                    <p class="jino-devasia-maliyekkal-container">
                                        <span class="jino-devasia">
                                            <%= shippingAddress[0].Address_id.FirstName %>
                                                <%= shippingAddress[0].Address_id.LastName %>
                                        </span>
                                        <span class="maliyekkal-house">
                                            <%= shippingAddress[0].Address_id.House_number %>
                                        </span>
                                        <span class="poolakutty-postkannur">
                                            <%= shippingAddress[0].Address_id.Address_line_1 %>
                                                <%= shippingAddress[0].Address_id.Address_line_2 %>
                                        </span>
                                        <span class="kerala-india-670650">
                                            <%= shippingAddress[0].Address_id.Postal_code %>
                                                <%= shippingAddress[0].Address_id.State %>
                                                    <%= shippingAddress[0].Address_id.Country %>
                                        </span>
                                    </p>
                                </div>
                            </div>
                            <button class="button3">
                                <a style="all: unset;font-size: 16px;color: white;" class="view-all-products1"
                                    href="/user/updateaddress/<%= shippingAddress[0]._id %>">
                                    Edit Address
                                </a>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
            <% } %>
                <% if (billingAddress && billingAddress.length> 0) { %>
                    <div class="col-lg-4 col-md-6 col-sm-6">
                        <div class="product__item">
                            <div class="product__item__text">
                                <div class="address-type">
                                    <div class="address-heading">
                                        <div class="address-label">
                                            <div class="address-name">
                                                <div class="default-shipping-address">
                                                    Default Billing Address
                                                </div>
                                            </div>
                                            <p class="jino-devasia-maliyekkal-container">
                                                <span class="jino-devasia">
                                                    <%= billingAddress[0].Address_id.FirstName %>
                                                        <%= billingAddress[0].Address_id.LastName %>
                                                </span>
                                                <span class="maliyekkal-house">
                                                    <%= billingAddress[0].Address_id.House_number %>
                                                </span>
                                                <span class="poolakutty-postkannur">
                                                    <%= billingAddress[0].Address_id.Address_line_1 %>
                                                        <%= billingAddress[0].Address_id.Address_line_2 %>
                                                </span>
                                                <span class="kerala-india-670650">
                                                    <%= billingAddress[0].Address_id.Postal_code %>
                                                        <%= billingAddress[0].Address_id.State %>
                                                            <%= billingAddress[0].Address_id.Country %>
                                                </span>
                                            </p>
                                        </div>
                                    </div>
                                    <button class="button3">
                                        <a style="all: unset;font-size: 16px;color: white;" class="view-all-products1"
                                            href="/user/updateaddress/<%= billingAddress[0]._id %>">
                                            Edit Address
                                        </a>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                    <% } %>
    </div>
</div>
<div>
    <div class="addresses-content-wrapper">
        <div class="addresses-content">
                <!-- <div class="addresses-heading">
                    <div class="all-addresses">All Addresses</div>
                </div> -->
            <div class="products-button">
                <button class="button5">
                    <div class="view-all-products3" id="viewAllProducts2">
                        Add New Address
                    </div>
                </button>
            </div>
            <% if (address && address.length> 0) { %>
                <div class="row">
                    <% address.forEach((user, index)=> { %>
                        <div class="col-lg-4 col-md-6 col-sm-6">
                            <div class="product__item">
                                <div class="product__item__text">
                                    <div class="address-item">
                                        <div class="address-details">
                                            <p class="jino-devasia-maliyekkal-container2">
                                                <span class="jino-devasia2">
                                                    <%= user.Address_id.FirstName %>
                                                        <%= user.Address_id.LastName %>
                                                </span>
                                                <span class="maliyekkal-house2">
                                                    <%= user.Address_id.House_number %>
                                                </span>
                                                <span class="poolakutty-postkannur2">
                                                    <%=
                                                            user.Address_id.Address_line_2 %>
                                                </span>
                                                <span class="kerala-india-6706502">
                                                    <%= user.Address_id.City %>, <%= user.Address_id.State %>,<%= user.Address_id.City %>, <%= user.Address_id.Country %>, <%=
                                                                user.Address_id.Postal_code %>
                                                </span>
                                            </p>
                                        </div>
                                        <div class="shipping-action ">
                                            <div class="shipping-button pb-2">
                                                <a href="/user/setshipping/<%= user._id %>" class="set-as-shipping">
                                                    Set as Shipping Address
                                                </a>
                                            </div>
                                            <div class="delete-edit-action">
                                                <div class="delete-edit-button">
                                                    <a href="#" class="delete"
                                                        onclick="handleDelete('<%= user._id %>')">
                                                        Delete
                                                    </a>
                                                    <a href="/user/updateaddress/<%= user._id %>" class="edit">
                                                        Edit
                                                    </a>
                                                </div>
                                                <div class="billing-action px-2">
                                                    <div class="set-as-billing pb-2">
                                                        <a href="/user/setbilling/<%= user._id %>"
                                                            class="set-as-shipping">
                                                            Set as Billing Address
                                                        </a>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <% }); %>
                </div>
                <% } else { %>
                    <p>No addresses found for the user.</p>
                    <% } %>
        </div>
    </div>
</div>

      <!-- Footer Section Begin -->
            <footer class="footer">
                <div class="container">
                    <div class="row">
                        <div class="col-lg-3 col-md-6 col-sm-6">
                            <div class="footer__about">
                                <div class="footer__logo">
                                    <a href="#"
                                        ><img src="img/footer-logo.png" alt=""
                                    /></a>
                                </div>
                                <p>
                                    The customer is at the heart of our unique
                                    business model, which includes design.
                                </p>
                                <a href="#"
                                    ><img src="img/payment.png" alt=""
                                /></a>
                            </div>
                        </div>
                        <div class="col-lg-2 offset-lg-1 col-md-3 col-sm-6">
                            <div class="footer__widget">
                                <h6>Shopping</h6>
                                <ul>
                                    <li><a href="#">Clothing Store</a></li>
                                    <li><a href="#">Trending Shoes</a></li>
                                    <li><a href="#">Accessories</a></li>
                                    <li><a href="#">Sale</a></li>
                                </ul>
                            </div>
                        </div>
                        <div class="col-lg-2 col-md-3 col-sm-6">
                            <div class="footer__widget">
                                <h6>Shopping</h6>
                                <ul>
                                    <li><a href="#">Contact Us</a></li>
                                    <li><a href="#">Payment Methods</a></li>
                                    <li><a href="#">Delivary</a></li>
                                    <li><a href="#">Return & Exchanges</a></li>
                                </ul>
                            </div>
                        </div>
                        <div class="col-lg-3 offset-lg-1 col-md-6 col-sm-6">
                            <div class="footer__widget">
                                <h6>NewLetter</h6>
                                <div class="footer__newslatter">
                                    <p>
                                        Be the first to know about new arrivals,
                                        look books, sales & promos!
                                    </p>
                                    <form action="#">
                                        <input
                                            type="text"
                                            placeholder="Your email"
                                        />
                                        <button type="submit">
                                            <span class="icon_mail_alt"></span>
                                        </button>
                                    </form>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-lg-12 text-center">
                            <div class="footer__copyright__text">
                             <!-- Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0. -->   
                                <p>
                                    Copyright ©
                                    <script>
                                        document.write(new Date().getFullYear())
                                    </script>
                                    2020 All rights reserved | This template is
                                    made with
                                    <i
                                        class="fa fa-heart-o"
                                        aria-hidden="true"
                                    ></i>
                                    by
                                    <a
                                        href="https://colorlib.com"
                                        target="_blank"
                                        >Colorlib</a
                                    >
                                </p>
                                <!-- Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0. -->
                            </div>
                        </div>
                    </div>
                </div>
            </footer>
            <!-- Footer Section End -->

            <!-- Search Begin -->
            <div class="search-model">
                <div
                    class="h-100 d-flex align-items-center justify-content-center"
                >
                    <div class="search-close-switch">+</div>
                    <form class="search-model-form">
                        <input
                            type="text"
                            id="search-input"
                            placeholder="Search here....."
                        />
                    </form>
                </div>
            </div>
            <!-- Search End -->
        </div>
        <!-- Js Plugins -->
        <script src="js/jquery-3.3.1.min.js"></script>
        <script src="js/bootstrap.min.js"></script>
        <script src="js/jquery.nice-select.min.js"></script>
        <script src="js/jquery.nicescroll.min.js"></script>
        <script src="js/jquery.magnific-popup.min.js"></script>
        <script src="js/jquery.countdown.min.js"></script>
        <script src="js/jquery.slicknav.js"></script>
        <script src="js/mixitup.min.js"></script>
        <script src="js/owl.carousel.min.js"></script>
        <script src="js/main.js"></script>

        <script>
            var linkContainer = document.getElementById("linkContainer")
            if (linkContainer) {
                linkContainer.addEventListener("click", function (e) {
                    // Please sync "Home Page/Login" to the project
                })
            }

            var allProductsText = document.getElementById("allProductsText")
            if (allProductsText) {
                allProductsText.addEventListener("click", function (e) {
                    // Please sync "All Products" to the project
                })
            }

            var clothingText = document.getElementById("clothingText")
            if (clothingText) {
                clothingText.addEventListener("click", function (e) {
                    // Please sync "Clothing" to the project
                })
            }

            var shoesText = document.getElementById("shoesText")
            if (shoesText) {
                shoesText.addEventListener("click", function (e) {
                    // Please sync "Shoes" to the project
                })
            }

            var accessoriesText1 = document.getElementById("accessoriesText1")
            if (accessoriesText1) {
                accessoriesText1.addEventListener("click", function (e) {
                    // Please sync "Accessories" to the project
                })
            }

            var linkContainer = document.getElementById("linkContainer")
            if (linkContainer) {
                linkContainer.addEventListener("click", function (e) {
                    // Please sync "Search" to the project
                })
            }

            var linkContainer1 = document.getElementById("linkContainer1")
            if (linkContainer1) {
                linkContainer1.addEventListener("click", function (e) {
                    // Please sync "WishList" to the project
                })
            }

            var linkContainer = document.getElementById("linkContainer")
            if (linkContainer) {
                linkContainer.addEventListener("click", function (e) {
                    // Please sync "Mini Cart" to the project
                })
            }

            var linkContainer = document.getElementById("linkContainer")
            if (linkContainer) {
                linkContainer.addEventListener("click", function () {
                    window.open(
                        "https://themewagon.github.io/malefashion/index.html"
                    )
                })
            }

            var myPaymentOptions = document.getElementById("myPaymentOptions")
            if (myPaymentOptions) {
                myPaymentOptions.addEventListener("click", function (e) {
                    // Please sync "Digital Wallet" to the project
                })
            }

            var viewAllProducts2 = document.getElementById("viewAllProducts2")
            if (viewAllProducts2) {
                viewAllProducts2.addEventListener("click", function (e) {
                    window.location.href = "./addnewaddress"
                })
            }

            var linkContainer = document.getElementById("linkContainer")
            if (linkContainer) {
                linkContainer.addEventListener("click", function () {
                    window.open(
                        "https://themewagon.github.io/malefashion/shopping-cart.html"
                    )
                })
            }
        </script>
        <script>
    function handleDelete(addressId) {
        fetch(`/user/deleteaddres?id=${addressId}`, {
            method: 'PUT',
        }) .then(response => response.json())
        .then(data => {
            if (data.message === 'Address deleted successfully') {
                window.location.href = "/user/address";  // Redirect to the address page
            } else {
                alert('Failed to delete address');
            }
        })
        .catch(error => {
            console.error('Error:', error);
        });
    
       
    }
    

   
</script>
    </body>
</html>
